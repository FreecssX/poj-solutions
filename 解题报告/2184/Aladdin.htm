<html><head>
<meta http-equiv="Content-Type" content="text/html; charset=gb2312">
<title>Source Code</title></head><body>
<p align=center><font size=4 color=#333399>Source</font></p>
<p align=center><font size=2>Problem Id:2184&nbsp;&nbsp;User Id:Aladdin
<br>Memory:412K&nbsp;&nbsp;Time:45MS<br>
Language:G++&nbsp;&nbsp;Result:Accepted</font></p>
<ul><li><font color=#333399 size=5>Source</font></li>
<p><font face=Times New Roman size=3>
<pre>#include &lt;iostream&gt;
#include &lt;algorithm&gt;
#include &lt;cstdio&gt;
using namespace std;

const int INF = 0x7fffffff;

int f0[2000 * 100 + 1], *f = f0 + 1000 * 100;
int N, pA[100], pB[100], L = 0, H = 0;

int main()
{
	int i, j, k;
	scanf("%d", &#38;N);
	for(i = 0; i &lt; N; ++i)
	{
		scanf("%d%d", &#38;pA[i], &#38;pB[i]);
		if(pA[i] &lt; 0)
			L += pA[i];
		else
			H += pA[i];
	}
	fill(f + L, f + H + 1, -INF);
	f[0] = 0;
	L = 0;
	H = 0;
	for(i = 0; i &lt; N; ++i)
		if(pA[i] &lt; 0)
		{
			for(j = L; j &lt;= H; ++j)
				if(f[j] != -INF && f[j] + pB[i] &gt; f[j + pA[i]])
					f[j + pA[i]] = f[j] + pB[i];
			L += pA[i];
		} else
		{
			for(j = H; j &gt;= L; --j)
				if(f[j] != -INF && f[j] + pB[i] &gt; f[j + pA[i]])
					f[j + pA[i]] = f[j] + pB[i];
			H += pA[i];
		}
	int ans = 0;
	for(i = 0; i &lt;= H; ++i)
		if(f[i] &gt;= 0 && i + f[i] &gt; ans)
			ans = i + f[i];
	cout &lt;&lt; ans &lt;&lt; endl;
	return 0;
}
</pre>
</font></p></ul>
</body></html>
